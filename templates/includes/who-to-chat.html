{% extends "base.html" %}
{% load static %}

{% block contents %}

    <!--Add to Bookmark popup-->
    <div id="chat-open-pop" class="fixed hidden top-0 w-full h-screen bg-black/40 p-4 mx-auto items-center justify-center">
        <div class="flex flex-col items-center p-6 w-[80vw] lg:w-[40vw] rounded-lg bg-bgColor gap-4">
            <div class="flex items-center justify-between w-full">
                <h3 class="text-white font-semibold text-lg">Select new buddy to chat with</h3>
                <div id="close-pop-btn"><i class="fa-solid fa-xmark cursor-pointer" style="color: #FFFFFF;"></i></div>
            </div>
            <div class="flex flex-col items-start w-full max-h-[60vh] lg:max-h-[70vh] overflow-auto">
                {% for user in all_buddies %}
                <form action="" method="POST" class="flex py-4 items-center justify-between gap-4 border-t border-textCol/40 w-full">
                    {% csrf_token %}
                    <input type="hidden" value="{{ user.user.id}}" name="receiver-user-id">
                    <button class="flex justify-between items-center w-full">
                        <div class="flex items-center gap-4">
                            {% if user.profile.profile_picture %}
                                <img src="{{ user.profile.profile_picture.url }}" alt="" srcset="" class="w-[3rem] rounded-full">
                            {% else %}
                                <img src="{% static "images/blank-picture.png" %}" alt="" srcset="" class="w-[3rem] rounded-full">
                            {% endif %}
                            <div class="flex flex-col items-start">
                                {% if user.profile.display_name %}
                                <h5 class="text-white">{{ user.profile.display_name }}</h5>
                                {% else %}
                                    <h5 class="text-white">{{ user.user.username|capfirst}}</h5>
                                {% endif %}
                                <p class="text-textCol">@{{ user.user.username|lower}}</p>
                            </div>
                        </div>
                        <i class="fa-regular fa-comment-dots" style="color: #ffffff;"></i>
                    </button>
                </form>
                {% endfor %}
            </div>
        </div>
    </div>


<!--Add to Bookmark Script-->
<script>
    const elementss = document.querySelectorAll('.chat-button');
    const close_chat_box = document.getElementById("close-pop-btn");
    const open_chat_box = document.getElementById("chat-open-pop")

    
    elementss.forEach((element) => {
        element.addEventListener('click', openChatPop);
        
        function openChatPop(e) {
            e.preventDefault();
            open_chat_box.classList.remove('hidden')
            open_chat_box.classList.add('flex')
        }
    });

    close_chat_box.addEventListener('click', closeChatPop);
    function closeChatPop() {
        open_chat_box.classList.remove('flex')
        open_chat_box.classList.add('hidden')
    }
</script>



{% endblock contents %}
